import{E as ue,I as pe,L as me,O as _,P as fe,m as N,o as se,q as le,v as ce,y as de}from"./chunk-RV7ZK7W7.js";import"./chunk-HUVRVVUX.js";import"./chunk-QF3VC3SV.js";import"./chunk-NWREVSQI.js";import"./chunk-ZALL7XZV.js";import{De as ne,Ee as oe,Za as ee,bb as o,gb as x,hb as te,ia as V,je as ae,ke as re,me as ie,oa as X}from"./chunk-BQCGASCG.js";import"./chunk-OJDNZKOE.js";import"./chunk-J6PD7XEE.js";import{$b as S,Cb as B,Eb as p,F as I,Hd as K,Ka as b,Lb as Y,Mb as $,Nb as j,O,Rb as H,Sb as s,W as q,X as M,Xc as G,Yg as J,_b as Q,a as D,b as E,db as U,ea as g,gb as h,ja as y,k as P,ob as Z,qa as m,ra as f,tb as l,tc as W,ub as c,vb as C,w as A,xa as L,z as R,zb as z}from"./chunk-QJF26QUV.js";function Ce(n,e){if(n&1){let t=z();l(0,"fdp-table",2,0),B("columnsChange",function(r){m(t);let i=p();return f(i.columnChangeCallback(r))})("filterChange",function(r){m(t);let i=p();return f(i.filtersChangeCallback(r))})("sortChange",function(r){m(t);let i=p();return f(i.sortingChangeCallback(r))})("rowToggleOpenState",function(r){m(t);let i=p();return f(i.rowToggleCallback(r))})("pageChange",function(r){m(t);let i=p();return f(i.pageChangeCallback(r))})("tableScrolled",function(r){m(t);let i=p();return f(i.setTableOffset(r))})("rowsRearrange",function(r){m(t);let i=p();return f(i.onRowsRearrange(r))})("cellFocused",function(r){m(t);let i=p();return f(i.onCellFocused(r))}),C(2,"fdp-table-toolbar",3)(3,"fdp-column",4)(4,"fdp-column",5)(5,"fdp-column",6)(6,"fdp-column",7)(7,"fdp-column",8),c(),C(8,"fdp-table-p13-dialog",9)}if(n&2){let t=H(1),a=p();h("dataSource",a.source)("initialVisibleColumns",a.columns)("initialSortBy",a.sortBy)("initialFilterBy",a.initialFilterBy)("initialPage",a.page)("pageScrolling",!0)("pageSize",4)("loadPagesBefore",!0)("isTreeTable",!0),b(3),h("sortable",!0)("groupable",!0)("filterable",!0),b(),h("sortable",!0)("filterable",!0),b(),h("sortable",!0)("filterable",!0),b(2),h("sortable",!0)("filterable",!0),b(),h("table",t)}}var he=(()=>{let e=class e{constructor(){this.sortBy=[{field:"price.value",direction:N.ASC}],this.columns=["name","price","status"],this.items=[...T],this._dateTimeAdapter=g(ee),this._cdr=g(W),this.source=new w(new k(this.items,this._dateTimeAdapter)),this.page=1,this.initialFilterBy=[],this.displayTable=!0,this.tableOffset=0,this.applyScroll=!1,this._destroyRef=g(L),this._refresh$=new P}toggleTable(){this.applyScroll=!this.displayTable,this.displayTable=!this.displayTable,this.items=[...T],this.source=new w(new k(this.items,this._dateTimeAdapter)),this._cdr.detectChanges(),this._listenOnTableData()}_listenOnTableData(){if(this._refresh$.next(),this._refresh$.complete(),this._refresh$=new P,!this.table)return;let a=I(K(this._destroyRef),this._refresh$);this.table._dataSourceDirective.onDataReceived.pipe(q(()=>this.table.tableRowsSet),M(a)).subscribe(()=>{this.applyScroll&&(this.applyScroll=!1,this.table.tableScrollable.setScrollTop(this.tableOffset,!1),this.focusedCell&&this.table.focusCell(this.focusedCell))})}ngAfterViewInit(){this._listenOnTableData()}columnChangeCallback(a){console.log(a),this.columns=a.current}filtersChangeCallback(a){console.log(a),this.initialFilterBy=a.current}sortingChangeCallback(a){console.log(a),this.sortBy=a.current}onRowsRearrange(a){console.log(a)}rowToggleCallback(a){let r=T.findIndex(i=>i.id===a.row.id);r!==-1&&(T[r].expanded=a.expanded)}pageChangeCallback(a){console.log(a),this.page=a.current.currentPage}setTableOffset(a){this.tableOffset=a}onCellFocused(a){this.focusedCell=a}};e.\u0275fac=function(r){return new(r||e)},e.\u0275cmp=y({type:e,selectors:[["fdp-platform-table-preserved-state-example"]],viewQuery:function(r,i){if(r&1&&Y(_,5),r&2){let d;$(d=j())&&(i.table=d.first)}},standalone:!0,features:[Q([te()]),S],decls:5,vars:1,consts:[["table",""],["fd-button","",3,"click"],["bodyHeight","10rem","relationKey","children","expandedStateKey","expanded","dropMode","group",3,"columnsChange","filterChange","sortChange","rowToggleOpenState","pageChange","tableScrolled","rowsRearrange","cellFocused","dataSource","initialVisibleColumns","initialSortBy","initialFilterBy","initialPage","pageScrolling","pageSize","loadPagesBefore","isTreeTable"],["title","Order Items"],["name","name","key","name","label","Name",3,"sortable","groupable","filterable"],["name","description","key","description","label","Description",3,"sortable","filterable"],["name","price","key","price.value","label","Price",3,"sortable","filterable"],["name","verified","key","verified","label","Verified"],["name","status","key","status","label","Status",3,"sortable","filterable"],[3,"table"]],template:function(r,i){r&1&&(l(0,"p"),s(1,"Toggle button destroys the table completely if it exists, and restores it's state when newly created."),c(),l(2,"button",1),B("click",function(){return i.toggleTable()}),s(3,"Toggle table"),c(),U(4,Ce,9,19)),r&2&&(b(4),Z(i.displayTable?4:-1))},dependencies:[J,fe,_,ue,me,pe,de,ce,x],encapsulation:2,changeDetection:0});let n=e;return n})(),w=class extends le{constructor(e){super(e)}},k=class extends se{constructor(e,t){super(),this.dateTimeAdapter=t,this.items=e,this.totalItems=this.items.length}fetchData(e){return this.fetch(e).pipe(R(t=>(this.searchInput&&(t=this.search(t,E(D({},e),{searchInput:this.searchInput}))),e?.filterBy&&(t=this.filter(t,e)),e?.sortBy&&(t=this.sort(e,t)),ge(t).slice((e.page.currentPage-1)*e.page.pageSize,e.page.currentPage*e.page.pageSize))),O(1e3))}fetch(e){let t=this.items;return A(t)}sort({sortBy:e},t){return t=t.slice(),e=e.filter(({field:a})=>!!a),e.length===0?t:t.sort((a,r)=>e.map(({field:i,direction:d})=>{let u=d===N.ASC?1:-1;return _e(a,r,i)*u}).find((i,d,u)=>i!==0||d===u.length-1)??0)}filter(e,{filterBy:t}){return t.filter(({field:a})=>!!a).forEach(a=>{e=e.filter(r=>{switch(a.field){case"name":case"description":return F(r,a);case"price.value":return this.filterByPrice(r,a);case"status":return this.filterByStatus(r,a);case"statusColor":return this.filterByStatusColor(r,a);case"verified":return xe(r,a);case"date":return Se(r,a,this.dateTimeAdapter);default:return!1}})}),e}filterByPrice(e,t){let a=t.value;if(a&&typeof a=="object"&&("min"in a||"max"in a)){let r=t.value,i=e.price.value,d=Number.parseFloat(r?.min),u=Number.parseFloat(r?.max);return(Number.isNaN(d)||i>=d)&&(Number.isNaN(u)||i<=u)}return ye(e,t)}filterByStatus(e,t){return Array.isArray(t.value)?be(e,t):F(e,t)}filterByStatusColor(e,t){return Array.isArray(t.value)?be(e,t):F(e,t)}},F=(n,e)=>{let t=e.value&&e.value.toLocaleLowerCase(),a=e.value2&&e.value2.toLocaleLowerCase()||"",r=v(e.field,n).toLocaleLowerCase(),i=!1;switch(e.strategy){case"equalTo":i=r===t;break;case"greaterThan":i=r>t;break;case"greaterThanOrEqualTo":i=r>=t;break;case"lessThan":i=r<t;break;case"lessThanOrEqualTo":i=r<=t;break;case"between":i=r>=t&&r<=a;break;case"beginsWith":i=r.startsWith(t);break;case"endsWith":i=r.endsWith(t);break;case"contains":default:i=r.includes(t)}return e.exclude?!i:i},ye=(n,e)=>{let t=Number.parseFloat(e.value),a=Number.parseFloat(e.value2)||0,r=Number.parseFloat(v(e.field,n)),i=!1;switch(e.strategy){case"greaterThan":i=r>t;break;case"greaterThanOrEqualTo":i=r>=t;break;case"lessThan":i=r<t;break;case"lessThanOrEqualTo":i=r<=t;break;case"between":i=r>=t&&r<=a;break;case"equalTo":default:i=r===t}return e.exclude?!i:i},Se=(n,e,t)=>{let a=e.value,r=e.value2,i=v(e.field,n),d=t.compareDate(i,a),u=!1;switch(e.strategy){case"after":u=d>0;break;case"onOrAfter":u=d>=0;break;case"before":u=d<0;break;case"beforeOrOn":u=d<=0;break;case"between":u=t.isBetween(i,a,r);break;case"equalTo":default:u=t.dateTimesEqual(i,a)}return e.exclude?!u:u},xe=(n,e)=>{let t=e.value,a=v(e.field,n),r=!1;switch(e.strategy){case"equalTo":default:r=a===t}return e.exclude?!r:r},be=(n,e)=>{let t=e.value,a=v(e.field,n),r=!1;switch(e.strategy){case"equalTo":default:r=t.includes(a)}return!t.length||e.exclude?!r:r},_e=(n,e,t)=>(t&&(n=v(t,n),e=v(t,e)),n>e?1:n===e?0:-1);function v(n,e){return n.split(".").reduce((t,a)=>t?t[a]:null,e)}function ge(n,e){return n.filter(t=>t.parentId===e).map(t=>E(D({},t),{children:ge(n,t.id)}))}var T=[{id:1,name:"10 Portable DVD player",description:"diam neque vestibulum eget vulputate",price:{value:66.04,currency:"CNY"},status:"Stocked on demand",statusColor:"informative",date:new o(2020,1,7),verified:!0,expanded:!1},{id:2,name:"Astro Laptop 1516",description:"pede malesuada",price:{value:489.01,currency:"EUR"},status:"Out of stock",statusColor:"negative",date:new o(2020,2,5),verified:!0,parentId:1},{id:3,name:"Benda Laptop 1408",description:"suspendisse potenti cras in",price:{value:243.49,currency:"CNY"},status:"Stocked on demand",statusColor:"informative",date:new o(2020,9,22),verified:!0,parentId:1},{id:4,name:"Astro Laptop 1516",description:"pede malesuada",price:{value:489.01,currency:"EUR"},status:"Out of stock",statusColor:"negative",date:new o(2020,2,5),verified:!0,expanded:!0,children:[]},{id:5,name:"10 Portable DVD player",description:"diam neque vestibulum eget vulputate",price:{value:66.04,currency:"CNY"},status:"Stocked on demand",statusColor:"informative",date:new o(2020,1,7),verified:!0,expanded:!0,parentId:4},{id:6,name:"Astro Phone 6",description:"penatibus et magnis",price:{value:154.1,currency:"IDR"},status:"Stocked on demand",statusColor:"informative",date:new o(2020,1,12),verified:!0,parentId:5},{id:7,name:"Beam Breaker B-1",description:"fermentum donec ut",price:{value:36.56,currency:"NZD"},status:"Stocked on demand",statusColor:"informative",date:new o(2020,11,24),verified:!1,parentId:5},{id:8,name:"Beam Breaker B-2",description:"sapien in sapien iaculis congue",price:{value:332.57,currency:"NZD"},status:"No info",date:new o(2020,10,23),verified:!0,parentId:5},{id:9,name:"Astro Phone 6",description:"penatibus et magnis",price:{value:154.1,currency:"IDR"},status:"Stocked on demand",statusColor:"informative",date:new o(2020,1,12),verified:!0},{id:10,name:"Beam Breaker B-1",description:"fermentum donec ut",price:{value:36.56,currency:"NZD"},status:"Stocked on demand",statusColor:"informative",date:new o(2020,11,24),verified:!1},{id:11,name:"Beam Breaker B-2",description:"sapien in sapien iaculis congue",price:{value:332.57,currency:"NZD"},status:"No info",date:new o(2020,10,23),verified:!0},{id:12,name:"Benda Laptop 1408",description:"suspendisse potenti cras in",price:{value:243.49,currency:"CNY"},status:"Stocked on demand",statusColor:"informative",date:new o(2020,9,22),verified:!0},{id:13,name:"Bending Screen 21HD",description:"nunc nisl duis bibendum",price:{value:66.46,currency:"EUR"},status:"Available",statusColor:"positive",date:new o(2020,8,14),verified:!1},{id:14,name:"Blaster Extreme",description:"quisque ut",price:{value:436.88,currency:"USD"},status:"Available",statusColor:"positive",date:new o(2020,8,15),verified:!0},{id:15,name:"Broad Screen 22HD",description:"ultrices posuere",price:{value:458.18,currency:"CNY"},status:"Available",statusColor:"positive",date:new o(2020,5,4),verified:!0},{id:16,name:"Camcorder View",description:"integer ac leo pellentesque",price:{value:300.52,currency:"USD"},status:"Available",statusColor:"positive",date:new o(2020,5,5),verified:!0},{id:17,name:"Cepat Tablet 10.5",description:"rutrum rutrum neque aenean auctor",price:{value:365.12,currency:"NZD"},status:"No info",date:new o(2020,5,6),verified:!0},{id:18,name:"Ergo Mousepad",description:"tortor duis mattis egestas",price:{value:354.46,currency:"EUR"},status:"Stocked on demand",statusColor:"informative",date:new o(2020,5,7),verified:!0},{id:19,name:"Ergo Screen E-I",description:"massa quis augue luctus tincidunt",price:{value:387.23,currency:"NZD"},status:"Stocked on demand",statusColor:"informative",date:new o(2020,3,23),verified:!0},{id:20,name:"Ergo Screen E-II",description:"orci eget",price:{value:75.86,currency:"EUR"},status:"No info",date:new o(2020,3,20),verified:!1},{id:21,name:"Gaming Monster",description:"cubilia curae",price:{value:152.95,currency:"EGP"},status:"No info",date:new o(2020,9,20),verified:!1},{id:22,name:"Gaming Monster Pro",description:"pharetra magna vestibulum aliquet",price:{value:213.47,currency:"MZN"},status:"Out of stock",statusColor:"negative",date:new o(2020,4,17),verified:!1}];var Te="preserved-state/platform-table-preserved-state-example.component.html",we="preserved-state/platform-table-preserved-state-example.component.ts",rt=(()=>{let e=class e{constructor(){this.childService=g(ne),this.route=g(G),this.preservedStateFiles=[{language:"html",code:V(Te),fileName:"platform-table-preserved-state-example",name:"platform-table-preserved-state-example"},{language:"typescript",code:V(we),fileName:"platform-table-preserved-state-example",component:"PlatformTablePreservedStateExampleComponent",name:"platform-table-preserved-state-example"}],this.childService.setLink(this.route.snapshot.routeConfig?.path)}};e.\u0275fac=function(r){return new(r||e)},e.\u0275cmp=y({type:e,selectors:[["fdp-doc-preserved-state-docs"]],standalone:!0,features:[S],decls:32,vars:1,consts:[["id","preserved-state","componentName","table"],[3,"exampleFiles"]],template:function(r,i){r&1&&(l(0,"fd-docs-section-title",0),s(1," Preserving table state"),c(),l(2,"description")(3,"p"),s(4," In some cases, application should preserve the state of the table (current page, filters, grouping, sorting, etc) while navigating over pages. "),c(),l(5,"p"),s(6," To do so, developers can take advantage of using "),l(7,"code"),s(8,"initial[Property]"),c(),s(9," input properties and "),l(10,"code"),s(11,"[property]Change"),c(),s(12," output events. "),c(),l(13,"p"),s(14," Developers can also listen to a table body scroll event with the help of "),l(15,"code"),s(16,"(tableScrolled)"),c(),s(17," output event, when "),l(18,"code"),s(19,"[pageScrolling]"),c(),s(20," input property is "),l(21,"code"),s(22,"true"),c(),s(23,". "),c(),l(24,"p"),s(25," The example below demonstrates how to pass initial state and store changed state locally, then recreate the table component and pass updated state to it. "),c(),l(26,"p"),s(27," The logic behind it is to keep loaded data source items in memory, manipulate their properties when some event from table emits, and reuse this data on new table initialization. "),c()(),l(28,"component-example"),C(29,"fdp-platform-table-preserved-state-example"),c(),C(30,"code-example",1)(31,"separator")),r&2&&(b(30),h("exampleFiles",i.preservedStateFiles))},dependencies:[ie,re,ae,he,X,oe,x],encapsulation:2,changeDetection:0});let n=e;return n})();export{rt as PreservedStateDocsComponent};
